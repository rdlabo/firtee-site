<!doctype html>
<html class="no-js" lang="ja">
<head>
	<meta charset="utf-8">
	<meta http-equiv="x-ua-compatible" content="ie=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>tipsys｜都内で女友達を探す女性専用マッチングサービス</title>
	<link rel="stylesheet" href="app.css">
	<link rel="stylesheet" href="fonts/style.css">
	<link href='https://fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'>

	<meta name="twitter:card" content="summary">
	<meta name="twitter:site" content="@tipsys_info">
	<meta name="twitter:title" content="tipsys.me">
	<meta name="twitter:description" content="女友だちをつくる女性専用ソーシャルサービス">
	<meta name="twitter:image" content="https://tipsys.me/img/ogp.jpg">

	<meta property="og:title" content="tipsys.me">
	<meta name="description" content="女友だちをつくる女性専用ソーシャルサービス">
	<meta name="keywords" content="radyapp,tipsys,東京姉妹,合コン,夜遊び,飲み会,友達募集,アプリ">
	<meta property="og:type" content="article">
	<meta property="og:url" content="https://tipsys.me/">
	<meta property="og:site_name" content="tipsys.me">
	<meta property="og:description" content="女友だちをつくる女性専用ソーシャルサービス">
	<meta property="og:image" content="https://tipsys.me/img/ogp.jpg">
</head>

<body class="sub-page">
<header>
	<div class="row">
		<a href="index.html"><img src="images/logo_tipsys01.svg" alt="tipsys" width="300"></a>
	</div>
</header>

<div class="row">
	<section class="sub columns medium-8 small-12" id="verifyEmailSuccess" style="display:none;">
		<h3>メールアドレスの確認</h3>
		<p>
			メールアドレス認証に成功しました。アプリに戻って、tipsysをご利用ください。
		</p>
	</section>

	<section class="sub columns medium-8 small-12" id="verifyEmailFail" style="display:none;">
		<h3>確認できませんでした。再度お試しください</h3>
		<p>
			メールアドレスの確認を試みましたが、このURLは期限が切れているか、すでに確認が完了しています。
		</p>
	</section>

	<section class="sub columns medium-8 small-12" id="methodReset" style="display:none;">
		<h3>変更後のパスワード</h3>
		<label>パスワード
			<input type="text" id="changePasswordValue" placeholder="変更するパスワードをご入力ください">
		</label>
		<button class="button small" onclick="handleResetPassword();">パスワード決定</button>
	</section>


	<section class="sub columns medium-8 small-12" id="resetPasswordSuccess" style="display:none;">
		<h3>パスワード変更の確認</h3>
		<p>
			パスワード変更の成功しました。アプリに戻って、tipsysをご利用ください。
		</p>
	</section>

	<section class="sub columns medium-8 small-12" id="resetPasswordFail" style="display:none;">
		<h3>確認できませんでした。再度お試しください</h3>
		<p>
			パスワード変更を試みましたが、このURLは期限が切れているか、すでに変更が完了しています。
		</p>
	</section>

	<section class="sub columns medium-8 small-12" id="methodFail" style="display:none;">
		<h3>確認できませんでした</h3>
		<p>
			このURLは許可されておりません。
		</p>
	</section>
</div>
<footer class="article">
	<div class="row">
		<div class="columns medium-12">
			<ul class="flex-button">
				<li><a href="index.html">トップページ</a></li>
				<li><a href="policy.html">利用規約</a></li>
				<li><a href="https://www.rdlabo.jp/page/875">プライバシーポリシー</a></li>
				<li><a href="https://www.rdlabo.jp/page/559">特定商取引法表記 / サポート</a></li>
			</ul>
			<br />
			<div class="text-center"><small>© 2016 tipsys.me</small></div>
		</div>
	</div>
</footer>

<script src="https://www.gstatic.com/firebasejs/4.3.1/firebase.js"></script>
<script>
  let actionCode, continueUrl, auth;

  document.addEventListener('DOMContentLoaded', function() {
    const mode = getParameterByName('mode');
    const config = {
      'apiKey': 'AIzaSyClCsmx0yHhYcYDkqHnwp1ReG04ov66j78'
    };
    const app = firebase.initializeApp(config);
    actionCode = getParameterByName('oobCode');
    continueUrl = getParameterByName('continueUrl');
    auth = app.auth();

    switch (mode) {
      case 'verifyEmail':
        handleVerifyEmail(auth, actionCode, continueUrl);
        break;
      case 'resetPassword':
        const selectDomReset = document.querySelector('#methodReset');
        selectDomReset.style.display = 'block';
        break;
      default:
        const selectDomFail = document.querySelector('#methodFail');
        selectDomFail.style.display = 'block';
    }
  }, false);

  function handleVerifyEmail(auth, actionCode, continueUrl) {
    auth.applyActionCode(actionCode).then(function(resp) {
      const selectDom = document.querySelector('#verifyEmailSuccess');
      selectDom.style.display = 'block';
    }).catch(function(error) {
      const selectDom = document.querySelector('#verifyEmailFail');
      selectDom.style.display = 'block';
    });
  }

  function getParameterByName( name ){
    name = name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
    const regexS = "[\\?&]"+name+"=([^&#]*)";
    const regex = new RegExp( regexS );
    const results = regex.exec( window.location.href );
    if( results == null )
      return "";
    else
      return decodeURIComponent(results[1].replace(/\+/g, " "));
  }

  function handleResetPassword() {
    const newPassword = document.getElementById('changePasswordValue').value;
    if(newPassword.length < 6) {
      alert('パスワードの文字数が少なすぎます。6文字以上をご入力ください');
      return;
		}

    auth.confirmPasswordReset(actionCode, newPassword).then(function(resp) {
      const selectDomReset = document.querySelector('#methodReset');
      selectDomReset.style.display = 'none';

      const selectDomResetSuccess = document.querySelector('#resetPasswordSuccess');
      selectDomResetSuccess.style.display = 'block';
    }).catch(function(error) {
      const selectDomReset = document.querySelector('#methodReset');
      selectDomReset.style.display = 'none';

      const selectDomResetSuccess = document.querySelector('#resetPasswordFail');
      selectDomResetSuccess.style.display = 'block';
    });
  }

</script>

</body>
</html>
